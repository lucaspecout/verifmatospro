{% if branch.node.node_type == 'container' %}
  <div class="checklist-section">
    <div class="checklist-section-header">
      <h2>{{ branch.node.name }}</h2>
      {% if branch.status %}
        <span class="section-status {{ branch.status }}">{{ branch.status }}</span>
      {% endif %}
    </div>
    {% if branch.children %}
      <div class="checklist-section-body">
        {% for child in branch.children %}
          {% set branch = child %}
          {% include "partials/public_node.html" %}
        {% endfor %}
      </div>
    {% endif %}
  </div>
{% else %}
  <div class="checklist-item {{ branch.status or '' }}">
    <div class="checklist-item-title">
      <strong>{{ branch.node.name }}</strong>
      <div class="checklist-item-meta">
        <span class="qty">Attendu: {{ branch.node.expected_qty or '-' }}</span>
        {% if branch.status %}
          <span class="status">{{ branch.status }}</span>
        {% endif %}
      </div>
    </div>
    <form method="post" action="/public/{{ event.id }}/{{ token }}/item/{{ branch.node.id }}" class="checklist-form">
      <input type="text" name="comment" placeholder="Commentaire si problème" />
      <div class="checklist-actions">
        <button class="toggle-btn ok" type="submit" name="status" value="ok">OK</button>
        <button class="toggle-btn problem" type="submit" name="status" value="problem">Problème</button>
      </div>
    </form>
  </div>
{% endif %}
